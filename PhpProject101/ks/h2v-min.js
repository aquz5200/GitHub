/* h2v.js version 3.5.1
    last modified at May 16 2015
    (c)tyz@freefielder.jp 
    For detail , please visit http://tategaki.info/h2v/
		Contact : tyz@freefielder.jp
    ** Don't remove this copyright message **
*/
var h2vconvert={version:"3.5.1",target:{},defaultval:{auto:!0,chars:25,fontsize:"16px",lineInterval:.4,rotate:!0,bar:!0,barForeColor:"#999",barBackColor:"#eee",showcredit:!0,multiCols:!0,splash:!0,fontSet:"gothic"},fontSet:{gothic:"'ヒラギノ角ゴ ProN','Hiragino Kaku Gothic ProN','ヒラギノ角ゴ Pro','Hiragino Kaku Gothic Pro','メイリオ','Meiryo','ＭＳ ゴシック','MS Gothic','SimHei','HiraKakuProN-W3','STHeitiJ-Medium','TakaoExゴシック','TakaoExGothic','MotoyaLCedar','Droid Sans Japanese','Droid Sans Fallback',monospace",mincho:"'ヒラギノ明朝 ProN','Hiragino Mincho ProN','ヒラギノ明朝 Pro','Hiragino Mincho Pro','ＭＳ 明朝','MS Mincho','SimSun','HiraMinProN-W3','STHeitiJ-Medium','TakaoEx明朝','TakaoExMincho','MotoyaLCedar','Droid Sans Japanese','Droid Sans Fallback',monospace"},tmpdiv:null,styleSet:!1,envs:{ua:"",isOld:!1,isIE8:!1,isIE:!1,isFF38:!1},init:function(e){var t=h2vconvert,i=t.envs.ua;if(t.envs.isOld){for(id in e)window.addEventListener?!function(e){window.addEventListener("load",function(){t.addErrBar(e,"最新のブラウザでは縦書きで閲覧できます")},!1)}(id):!function(e){window.attachEvent("onload",function(){t.addErrBar(e,"最新のブラウザでは縦書きで閲覧できます")})}(id);return!1}if(document.addEventListener)/safari/.test(i)?window.addEventListener("load",function(){t.startConvert(e)},!1):document.addEventListener("DOMContentLoaded",function(){t.startConvert(e)},!1);else if(/msie/.test(i)){try{document.documentElement.doScroll("left")}catch(n){return void setTimeout(function(){t.init(e)},0)}t.startConvert(e)}else window.onload=function(){t.startConvert(e)}},startConvert:function(e){var t=h2vconvert;!t.styleSet&&t.envs.isIE&&h2v_ie.setStyleSheet(),t.styleSet=!0;var i;for(i in e)tyz.getById(i)&&(t.target[i]=new t.h2v(e,i));for(i in e)if(tyz.getById(i)){try{t.ruby_enabler(i)}catch(n){t.onErr(tyz.getById(i),t.target[i])}t.target[i].org=tyz.getById(i).cloneNode(!0)}for(i in e)if(tyz.getById(i)){var a=t.target[i],r=tyz.getById(i);a.auto&&!tyz.getByClass(r,"h2v").length?(a.splash&&t.showSplash(i),function(e,i,n){setTimeout(function(){try{t.convert(e)}catch(a){t.onErr(i,n)}n.splash&&t.hideSplash(e)},1)}(i,r,a)):(a.bar&&t.addBar(a.id,"<span onclick=\"h2vconvert.switcher( '"+i+"');\">横→縦切替</span>"),r.style.visibility="visible")}},convert:function(e){var t,i,n=h2vconvert,a=n.target[e],r=tyz.getById(e);if(""==a.converted){tyz.setStyles(r,{fontFamily:a.fontSet,fontSize:a.fontsize}),tyz.getById("b"+e)&&tyz.getById("b"+e).parentNode.removeChild(tyz.getById("b"+e));var o,s=["SCRIPT","STYLE"];for(t=0;t<s.length;t++)for(o=tyz.getByTag(r,s[t]),i=o.length-1;i>=0;i--)r.parentNode.appendChild(o[i]);var l=tyz.getByTag(r,"PRE"),d=[];for(t=0;t<l.length;t++)d[t]=l[t].cloneNode(!0);for(r.innerHTML=r.innerHTML.replace(/[\f\n\r\t\v\u0020\u00A0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u2028\u2029\u2028\u2029\u202f\u205f]+/g," "),l=tyz.getByTag(r,"PRE"),t=0;t<l.length;t++)l[t].parentNode.replaceChild(d[t],l[t]);var h,c=tyz.getByTag(r,"CENTER");for(t=c.length-1;t>=0;t--)h=tyz.newEle("P",{},{textAlign:"center"}),h.appendChild(n.extractNodeContents(c[t])),c[t].parentNode.replaceChild(h,c[t]);r.normalize(),a.html=n.extractNodeContents(r);var g=a.chars*a.fsPX;n.tmpdiv=n.createTmpdiv(e),n.tmpdiv.style.height=g+"px";var p=n.separateLines(e,a.html,a.fsPX,g,0),y=tyz.newEle("DIV",{},{position:"absolute",left:"0"});for(t=0;t<p.length;t++)y.appendChild(p[t]);a.converted=y.cloneNode(!0)}else{var y=a.converted.cloneNode(!0),g=a.chars*a.fsPX;n.tmpdiv=n.createTmpdiv(e)}var u=[];a.multiCols?u=n.separateCols(e,y,1*g+1*a.fsPX):u[0]=n.oneCol(e,y,1*g+1*a.fsPX),r.innerHTML="";var f;for(f=a.multiCols?tyz.newEle("DIV",{"class":"h2v"},{fontSize:a.fontsize}):tyz.newEle("DIV",{"class":"h2v"},{fontSize:a.fontsize,direction:"rtl"}),a.bar&&n.addBar(a.id,"<span onclick=\"h2vconvert.switcher( '"+e+"');\">縦→横切替</span>"),t=0;t<u.length;t++)f.appendChild(u[t]),t!=u.length-1&&f.appendChild(tyz.newEle("DIV",{"class":"h2v_separator"}));if(a.showcredit){var v=tyz.newEle("DIV",{"class":"h2v_bar"},{marginTop:"10px",color:a.barForeColor,backgroundColor:a.barBackColor});v.innerHTML='<a href="http://tategaki.info/h2v/" target="_blank">h2v.js '+n.version+"</a>",f.appendChild(v)}a.cols=f.cloneNode(!0),r.appendChild(f),r.appendChild(tyz.newEle("DIV",{"class":"h2v_clearfix"})),n.removeTmpdiv(e),"visible"!=r.style.visibility&&(r.style.visibility="visible")},separateLines:function(e,t,i,n,a){function r(){h.mL+=h.lineSpace,h.mR+=h.lineSpace,s=tyz.newEle("SPAN",{"class":"h2v_e"},{marginLeft:tyz.round(h.mL,2)+"px",marginRight:tyz.round(h.mR,2)+"px",width:i+"px"}),h.flt&&(0!=h.floatCount&&"left"==h.flt&&(s.style.marginTop=h.fH+2+"px"),h.fW-=i+h.mL+h.mR,h.fW<0&&(h.flt=!1,h.floatCount=0))}var o,s,l=[],d=h2vconvert,h=d.target[e];h.mL=0,h.mR=0;var c=n;for(h.flt&&(c=n-h.fH);o=d.seekNodes(e,t,i,c,a,!0);){if("b"==d.isDispBlock(o,e)||d.isList(o)||d.isThru(o)){if("h2v_imgFloat_clear"==o.className){for(;h.fW>0;){var g=tyz.round(2*h.lineSpace+i,2);l[l.length]=tyz.newEle("SPAN",{"class":"h2v_e"},{marginLeft:h.lineSpace+"px",marginRight:h.lineSpace+"px",width:i+"px"}),h.fW-=g}h.flt=!1,c=n}"none"==d.getDispS(o,["display"],!1,e).display?(l[l.length]=tyz.newEle("DIV"),l[l.length-1].appendChild(d.extractRange(t,o))):(h.flt&&(h.fW-=tyz.PX(o.style.paddingLeft)+tyz.PX(o.style.padingRight)+tyz.PX(o.style.marginLeft)+tyz.PX(o.style.marginRight)+tyz.PX(o.style.width)),l[l.length]=d.extractRange(t,o))}else if(h.flt&&0==h.floatCount)h.mL+=h.lineSpace,h.mR+=h.lineSpace,l[l.length]=tyz.newEle("SPAN",{"class":"h2v_imgFloat"},{marginRight:Math.round(h.fW)+"px",marginLeft:"-"+Math.round(h.fW)+"px"}),"right"==h.flt&&(l[l.length-1].style.marginTop=c-h.fH+2+"px"),l[l.length-1].appendChild(d.extractRange(t,o));else if(r(),s.appendChild(d.extractRange(t,o)),l[l.length]=d.setTextAlign(s,c,h,i,0),t.hasChildNodes()){var p=t.firstChild;(d.isInline(p)||"SPAN"==p.nodeName)&&(""==p.innerHTML||" "==p.innerHTML)&&t.removeChild(p)}h.mL=0,h.mR=0,h.cH=0,h.fW>0?(c=n-h.fH,h.floatCount++):c=n,h.okuri=null}return t.hasChildNodes()&&(1!=t.childNodes.length||"#text"!=t.firstChild.nodeName||""!=t.firstChild.nodeValue)&&(r(),s.appendChild(d.extractNodeContents(t)),l[l.length]=d.setTextAlign(s,c,h,i,4)),l},setTextAlign:function(e,t,i,n,a){var r,o=h2vconvert;switch(e.hasChildNodes()&&"BR"==e.lastChild.nodeName&&(a=4,1!=e.childNodes.length&&e.removeChild(e.lastChild)),i.tAlign+a){case 0:case 4:case 7:return e}r=tyz.newEle("DIV",{},{fontSize:n+"px"}),r.appendChild(e),o.tmpdiv.appendChild(r);var s,l,d,h,c=0,g=0,p=0,y=0;if(3==i.tAlign){if((s=t-e.offsetHeight)>0){for(l=e.childNodes,d=0;d<l.length;d++)switch(h=l[d],h.nodeName){case"#text":g+=h.nodeValue.length;break;case"SPAN":case"RUBY":case"FONT":case"STRONG":case"BIG":case"SMALL":case"I":case"B":case"EM":case"A":c++}if((p=o.getExtraHeight(s,g))>0&&(e.style.lineHeight=n+p+"px"),s-=g*p,c>0&&0!=(y=Math.round(s/c)))for(d=0;d<l.length;d++)switch(h=l[d],h.nodeName){case"SPAN":case"RUBY":case"FONT":case"STRONG":case"BIG":case"SMALL":case"I":case"B":case"EM":case"A":h.style.marginBottom=tyz.PX(h.style.marginBottom)+y+"px"}}}else e.style.marginTop=tyz.PX(e.style.marginTop)+(t-e.offsetHeight)/i.tAlign+"px";return o.tmpdiv.removeChild(r),e},getExtraHeight:function(e,t){return 0==t?0:tyz.round(e/t,2)},getExtraHeight_webkit:function(e,t){return 0==t?0:Math.floor(e/t)},Okuri:function(e,t){if(!e)return null;if("#document-fragment"==e.nodeName)return null;var i,n,a;switch(i=e.nodeName){case"#text":return 0==e.length?this.Okuri(e.previousSibling,t):1==e.length?e:(n=e.splitText(e.length-1),e);case"SPAN":return a=tyz.getAttr(e,"class"),/h2v_kuto|h2v_kakko_b|h2v_tcy/.test(a)?(t++,t>=3?null:this.Okuri(e.previousSibling||e.parentNode.previousSibling,t)):/h2v_sp|h2v_cho|h2v_komoji/.test(a)?e.previousSibling||this.addBlank(e):/h2v_alpha/.test(a)?/okurare/.test(a)?(t++,t>=3?e:this.Okuri(e.previousSibling||e.parentNode.previousSibling,t)):null:this.Okuri(e.lastChild,t)||e.lastChild||this.addBlank(e);case"FONT":case"STRONG":case"BIG":case"SMALL":case"I":case"B":case"EM":case"SUB":case"SUP":case"A":case"MARK":case"TIME":case"METER":case"S":case"CITE":case"Q":case"DFN":case"ABBR":case"CODE":case"VAR":case"SAMP":case"KBD":return this.Okuri(e.lastChild,t)||e.lastChild||this.addBlank(e);case"RUBY":return a=tyz.getAttr(e,"class"),/okurare/.test(a)?(t++,t>=3?e:this.Okuri(e.previousSibling||e.parentNode.previousSibling,t)):null}return null},addBlank:function(e){var t=document.createTextNode("");return e.parentNode.insertBefore(t,e),t},seekNodes:function(e,t,i,n,a,r){function o(){0!=J&&(J=(J+tyz.PX(_.width))/2,g.mR=J+tyz.PX(_.marginRight))}function s(){var e=tyz.newEle("DIV",{"class":"h2v_imgFloat_clear"});return h.parentNode.insertBefore(e,h),e}var l,d,h=t.firstChild,c=h2vconvert,g=c.target[e],p=0,y=0,u=0;for(d=0;d<t.childNodes.length;d++){h=t.childNodes[d],l=h.nodeName,"SPAN"==l&&(l=c.getSpanFlag(h));var f;if(0==d&&r&&"#text"==l){if(h.nodeValue=h.nodeValue.replace(/^ /,""),0==h.nodeValue.length)continue;r=!0}switch("#text"!=l||c.span_match(t,/h2v_/)||""==h.nodeValue||(r=!1,c.addVTags(h),h=t.childNodes[d],l=h.nodeName,"SPAN"==l&&(l=c.getSpanFlag(h))),l){case"#text":if(y=(i+1*a)*h.length,0==y)break;if(u=n-g.cH,0>=u&&(u=0),g.cH+=y,tyz.ceil(u,2)<=tyz.floor(y,2)){var v=Math.floor(u/(i+1*a));if(0==v)return g.okuri||h.previousSibling||c.addBlank(h);if(v<h.length)return f=h.splitText(v),h}break;case 1:case 5:if(g.okuri)return g.okuri;(n-(g.cH-i))/i<1&&(g.okuri=c.Okuri(h.previousSibling,0)||h.previousSibling||c.addBlank(h)),g.cH+=i+a,h.style.lineHeight=i+a+"px";break;case 2:if(g.cH+=i+a,h.style.lineHeight=i+a+"px",h.style.marginBottom=a/2+"px",n-g.cH<=1)return g.okuri||h.previousSibling||c.addBlank(h);break;case 3:if(0!=a&&(tyz.setStyles(h,{lineHeight:i+a+"px",marginBottom:0}),c.envs.isIE8&&tyz.setStyles(h,{marginTop:a/2+"px",marginBottom:a/2+"px",lineHeight:"1em"})),g.cH+=i+a,n-g.cH<0)return g.okuri||h.previousSibling||c.addBlank(h);break;case 10:if(g.cH+=i+a,n-g.cH<0)return g.okuri||h.previousSibling||c.addBlank(h);tyz.setStyles(h,{marginTop:a/2+"px",marginBottom:a/2+"px"});break;case 4:var y=tyz.PX(c.getDispS(h,["width"],!0,e,!1).width);if(tyz.setStyles(h,{letterSpacing:"0px",lineHeight:"1em"}),g.cH+=y+a,h.done_h2v||tyz.setStyles(h,{width:y+"px",marginBottom:Math.ceil(y-i-a/2)+"px"}),n-g.cH<0){if(h.done_h2v)return h;if(h.previousSibling)return h.done_h2v=!0,h.previousSibling;if(c.isList(t)||"SPAN"==t.nodeName)return h.done_h2v=!0,c.addBlank(h)}i>=y&&(h.className="okurare "+h.className);break;case 6:var m=c.getLS(h,e),y=tyz.PX(c.getDispS(h,["width"],!0,e,!1).width);if(tyz.setStyles(h,{letterSpacing:m+"px",lineHeight:"1em"}),g.cH+=y,h.done_h2v||tyz.setStyles(h,{width:y+"px",marginBottom:Math.ceil(y-i-a/2)+"px",marginTop:a/2+"px"}),n-g.cH<0){if(h.done_h2v)return h;if(h.previousSibling)return h.done_h2v=!0,h.previousSibling;if(c.isList(t)||"SPAN"==t.nodeName)return h.done_h2v=!0,c.addBlank(h)}i>=y&&(h.className="okurare "+h.className);break;case 7:case"RB":case"RBC":p=g.cH,h.style.lineHeight=i+a+"px",c.seekNodes(e,h,i,1e3,a,!1),g.cH=p,h.style.MozTransform&&(h.style.MozTransform=null);break;case 9:case"RT":case"RTC":p=g.cH,c.seekNodes(e,h,i,1e3,0,!1),g.cH=p,h.style.MozTransform&&(h.style.MozTransform=null);break;case 0:case 8:case"FONT":case"STRONG":case"BIG":case"SMALL":case"I":case"B":case"EM":case"SUB":case"SUP":case"A":case"MARK":case"TIME":case"METER":case"S":case"CITE":case"Q":case"DFN":case"ABBR":case"CODE":case"VAR":case"SAMP":case"KBD":case"DIV":case"P":case"BLOCKQUOTE":case"UL":case"OL":case"DL":case"LI":case"DT":case"DD":case"H1":case"H2":case"H3":case"H4":case"H5":case"H6":case"ADDRESS":case"ARTICLE":case"ASIDE":case"FOOTER":case"HEADER":case"HGROUP":case"NAV":case"DETAILS":case"SECTION":case"SUMMARY":var z,_,S,b,k,x=c.isDispBlock(h,e),B=c.getLS(h,e),C=h.parentNode,b=0,C=h.parentNode;switch(C&&"#document-fragment"!=C.nodeName&&(b=c.getLS(h.parentNode,e)),x){case"i":if(g.okuri&&n-g.cH<0)return g.okuri;z=c.getNewProp(h,B,b,e,!0),_=z.ds,S=tyz.PX(_.fontSize),z.s.marginLeft=(-S-tyz.PX(_.paddingTop)-tyz.PX(_.paddingBottom)-tyz.PX(_.borderTopWidth)-tyz.PX(_.borderBottomWidth))/2+"px",8==l&&(z.s.marginLeft=tyz.PX(z.s.marginLeft)- -tyz.PX(_.borderTopWidth)/2+"px"),k=n-tyz.PX(_.marginLeft)-tyz.PX(_.paddingLeft)-tyz.PX(_.borderLeftWidth),0>=k&&(k=S),c.setLineMargin(e,S,_);var N=c.seekNodes(e,h,S,k,B,r);if(r=!1,N){var R=h.cloneNode(!1),w=c.extractRange(h,N);return R.appendChild(w),tyz.setStyles(R,z.s),R.done_h2v=!0,tyz.setStyles(R,{marginBottom:0,paddingBottom:0,borderBottomWidth:0}),tyz.setStyles(h,{marginLeft:0,paddingLeft:0,borderLeftWidth:0}),h.parentNode.insertBefore(R,h),R}g.cH+=1*z.xm,h.done_h2v||(z.s.width="1em",tyz.setStyles(h,z.s)),h.done_h2v=!0,h.previousSibling&&3!=h.previousSibling.nodeType&&(h.style.marginTop=-a/2+"px"),h.nextSibling&&(h.style.marginBottom=-a/2+"px");break;case"b":default:if(g.fW>0){var P=tyz.getStyle(h,"clear")||c.getDispS(h,["clear"],!1,e);if(P&&"none"!=P)return s()}z=c.getNewProp(h,B,0,e),_=z.ds,S=tyz.PX(_.fontSize),"static"!=_.position&&(h.style.position="static");var T=g.tAlign;switch(_.textAlign){case"justify":g.tAlign=3;break;case"center":g.tAlign=2;break;case"right":g.tAlign=1;break;case"left":default:g.tAlign=0}var L=tyz.PX(_.width),E=tyz.PX(_.height);n=0==L?n:L,z.xm=0==L?z.xm:0,k=n-z.xm,0>=k&&(k=S),c.setLineMargin(e,S);var X=c.separateLines(e,h,S,k,B);tyz.setStyles(h,z.s),(c.isInline(h)||"SPAN"==h.nodeName)&&tyz.setStyles(h,{cssFloat:"right"}),h.style.width=0==E?"auto":E+"px",0==L?h.style.height="auto":(h.style.height=null,h.style.minHeight=L+"px");for(var I=0;I<X.length;I++)h.appendChild(X[I]);if("LI"==l){var H=tyz.newEle("SPAN",{"class":"h2v_mark"});H.appendChild(document.createTextNode("・")),h.children[0].insertBefore(H,h.children[0].firstChild)}return g.tAlign=T,h}break;case"PRE":case"IFRAME":case"TABLE":case"TEXTAREA":case"FORM":case"AUDIO":case"CANVAS":case"EMBED":case"FIGURE":case"VIDEO":case"MENU":case"OBJECT":case"MAP":var _=c.getDispS(h,["width","marginTop","marginBottom","marginLeft","marginRight","paddingLeft","paddingRight","borderLeftWidth","borderRightWidth"],!0,e,!0),M=tyz.PX(_.marginLeft)+"px "+tyz.PX(_.marginTop)+"px "+tyz.PX(_.marginRight)+"px "+tyz.PX(_.marginBottom)+"px";return tyz.setStyles(h,{margin:M,paddingLeft:tyz.PX(_.paddingLeft)+"px",paddingRight:tyz.PX(_.paddingRight)+"px",borderLeftWidth:tyz.PX(_.borderLeftWidth)+"px",borderRightWidth:tyz.PX(_.borderRightWidth)+"px",width:tyz.PX(_.width)+"px",maxWidth:tyz.PX(_.width)+"px"}),"left"==g.flt&&g.fW>0&&tyz.setStyles(h,{paddingTop:g.fH+"px"}),h;case"RUBY":if(h.done_h2v){delete h.done_h2v,h.style.lineHeight=i+a+"px";var A=tyz.PX(c.envs.isIE8?h.style.height:c.getDispS(h,["height"],!0,e).height),D=tyz.floor(.7*i,2);if(g.cH+=A,g.mR-D<0&&(g.mR=D-i*(g.lineInterval/2)),n-g.cH<0)return n-A>0?h.previousSibling||c.addBlank(h):h;break}h=this.ruby_to_html4_style(h),p=g.cH,c.seekNodes(e,h,i,1e3,a,!1),g.cH=p;var A,W,F,V,O,U=0;tyz.setStyles(h,{fontSize:i+"px",lineHeight:i+a+"px"});var j=tyz.newEle("SPAN",{"class":"h2v_e"}),G=h.cloneNode(!0),Y=!1;j.appendChild(G),c.tmpdiv.appendChild(j),A=G.offsetHeight,W=G.offsetWidth,O=tyz.getByTag(G,"RBC"),F=tyz.getByTag(G,"RB"),c.envs.isFF38&&(F=tyz.getByClass(G,"psdo_rb"));var K=tyz.getByTag(G,"RT");if(c.envs.isFF38&&(K=tyz.getByClass(G,"psdo_rt")),K&&(K[0].style.display="none"),V=F[0].offsetHeight,K&&(K[0].style.display="table-cell"),A-V>0&&(F[0].style.lineHeight=Math.floor(A*i/V)+"px",Y=!0),c.tmpdiv.removeChild(j),h.style.height=A+"px",Y&&(h.style.marginTop=a/2+"px"),h.nextSibling&&3!=h.nextSibling.nodeType&&(h.style.marginBottom=a/2+"px"),A=A-U>0?A:U,g.cH+=A,n-g.cH<0){if(h.previousSibling)return h.done_h2v=!0,h.previousSibling;if(c.isList(t)||"SPAN"==t.nodeName)return h.done_h2v=!0,c.addBlank(h)}i>=A&&(h.className="okurare "+h.className),h.done_h2v=!0;var D=W-i;g.mR-D<0&&(g.mR=D-i*(g.lineInterval/2));break;case"IMG":var y,J,_=c.getDispS(h,["width","height","marginLeft","marginRight","paddingLeft","paddingRight","paddingTop","paddingBottom","borderLeftWidth","borderRightWidth","borderTopWidth","borderBottomWidth","marginTop","marginBottom","cssFloat"],!0,e);if(c.envs.isIE8&&(_.height=tyz.PX(h2v_ie.getOH(h))-tyz.PX(_.paddingTop)-tyz.PX(_.paddingBottom)-tyz.PX(_.borderTopWidth)-tyz.PX(_.borderBottomWidth)),y=tyz.PX(_.height)+tyz.PX(_.paddingTop)+tyz.PX(_.paddingBottom)+tyz.PX(_.marginTop)+tyz.PX(_.marginBottom)+tyz.PX(_.borderTopWidth)+tyz.PX(_.borderBottomWidth),J=tyz.PX(_.width)-g.fsPX+tyz.PX(_.paddingLeft)+tyz.PX(_.paddingRight)+tyz.PX(_.borderLeftWidth)+tyz.PX(_.borderRightWidth),_.maxWidth=_.width,_.maxHeight=_.height,h.done_h2v)return o(),h;if(("left"==_.cssFloat||"right"==_.cssFloat)&&n-y>i)return g.flt?s():(g.flt=_.cssFloat,_.cssFloat="none",tyz.setStyles(h,_),g.fH=y,g.fW=tyz.round(tyz.PX(_.width)+tyz.PX(_.paddingLeft)+tyz.PX(_.paddingRight)+tyz.PX(_.borderLeftWidth)+tyz.PX(_.borderRightWidth)+tyz.PX(_.marginLeft)+tyz.PX(_.marginRight),2),g.floatCount=0,h);if(_.cssFloat="none",tyz.setStyles(h,_),0>n-y&&h.previousSibling)return h.done_h2v=!0,h.previousSibling;if(g.cH+=y,n-g.cH<0&&h.previousSibling)return h.previousSibling;o();break;case"BR":return g.okuri||h;case"HR":return h.done_h2v?h:(h.done_h2v=!0,h.style.height=.8*tyz.PX(g.pageheight)+"px",g.okuri||h.previousSibling||c.addBlank(h));default:var N=c.seekNodes(e,h,i,n,0,!1);if(N)return N}if(h.nextSibling){var Q=h.nextSibling;if("b"==c.isDispBlock(Q,e)||c.isThru(Q))return g.okuri||h}}return g.okuri||!1},getSpanFlag:function(e){var t=tyz.getAttr(e,"class");return/h2v_kuto|h2v_kakko_b/.test(t)?1:/h2v_kakko_t/.test(t)?2:/h2v_komoji|h2v_rotate/.test(t)?3:/h2v_sp/.test(t)?4:/h2v_tcy/.test(t)?5:/h2v_alpha/.test(t)?6:/psdo_rb/.test(t)?7:/bousen_/.test(t)?8:/psdo_rt/.test(t)?9:/h2v_cho/.test(t)?10:0},oneCol:function(e,t,i){this.tmpdiv.appendChild(t);var n=t.offsetWidth+1,a=t.offsetHeight,r=tyz.PX(this.target[e].pagewidth)-3;r>n&&(n=r,t.style.width=n+"px");var o=tyz.newEle("DIV",{"class":"h2v_pinner"},{width:n+"px"});o.appendChild(t);var s=tyz.newEle("DIV",{"class":"h2v_oc"},{width:r+"px",height:a+15+"px",minHeight:i+"px"});return s.appendChild(o),s},separateCols:function(e,t,i){function n(t){var i,a,r,o,l=t.childNodes,d={};for(i=0;i<l.length;i++)if("#text"!=l[i].nodeName&&l[i].style)if(r=l[i].style,d.mR=tyz.PX(r.marginRight),d.bR=tyz.PX(r.borderRightWidth),d.pR=tyz.PX(r.paddingRight),d.w=tyz.PX(r.width),d.pL=tyz.PX(r.paddingLeft),d.bL=tyz.PX(r.borderLeftWidth),d.mL=tyz.PX(r.marginLeft),a=d.mR+d.bR+d.pR+d.w+d.pL+d.bL,h2vconvert.isThru(l[i])||h2vconvert.span_match(l[i],"h2v_e")||"i"==h2vconvert.isDispBlock(l[i],e)||"b"==h2vconvert.isDispBlock(l[i],e)&&!l[i].hasChildNodes()){if(v+=a,v-s>0)return a-h>=0?(v+=d.mL,p=v-m,{cnt:l[i],desc:"e"}):(v-=a,p=v-m,_&&(_.style.marginRight=S-v+"px",_.style.marginLeft=-(S-v)+"px",l[i].parentNode.insertBefore(_.cloneNode(!0),l[i]),_=null),{cnt:l[i].previousSibling||h2vconvert.addBlank(l[i]),desc:"e"});v+=d.mL}else if(h2vconvert.span_match(l[i],"h2v_imgFloat")){var c=v+a;c-s>0&&(S=c,_=l[i].cloneNode(!0))}else{var g=1*v;if(v+=d.mR,v-s>0)return z=s-g,o=l[i].cloneNode(!1),l[i].parentNode.insertBefore(o,l[i]),v+=d.bR+d.pR+d.w+d.pL+d.bL+d.mL,p=h,{cnt:o,desc:""};if(v+=d.bR+d.pR,v-s>0)return z=s-g,o=l[i].cloneNode(!1),l[i].parentNode.insertBefore(o,l[i]),v+=d.w+d.pL+d.bL+d.mL,p=h,{cnt:o,desc:""};var y=1*v,u=n(l[i]),f=v-y;if(f-Math.round(d.w)<0&&(f=d.w),null!==u)return v+=f+d.pL+d.bL+d.mL,"e"==u.desc&&0!=d.w?(o=l[i].cloneNode(!0),l[i].parentNode.insertBefore(o,l[i]),u.cnt=o,u.desc="",z=v-g):z+=d.mR+d.bR+d.pR,u;if(v=y+f,v-s>0)return z=s-g,o=l[i].cloneNode(!0),l[i].parentNode.insertBefore(o,l[i]),v+=d.pL+d.bL+d.mL,p=h,{cnt:o,desc:""};if(v+=d.pL+d.bL,v-s>0)return z=s-g,o=l[i].cloneNode(!0),l[i].parentNode.insertBefore(o,l[i]),v+=d.mL,p=h,{cnt:o,desc:""};if(v+=d.mL,v-s>0)return z=s-g,o=l[i].cloneNode(!0),l[i].parentNode.insertBefore(o,l[i]),p=h,{cnt:o,desc:""}}return null}function a(e,t){for(;;){if("#document-fragment"==e.nodeName)return!1;if(tyz.getAttr(e,"class")==t)return e;e=e.parentNode}}function r(){var e,i,n,r=tyz.getByTag(t,"IMG"),o=0,s=0,l=0,d=0,c=0;for(i=0;i<r.length;i++)e=a(r[i].parentNode,"h2v_e"),e!==!1&&(n=e.style,o=tyz.PX(n.width)+tyz.PX(n.marginLeft)+tyz.PX(n.marginRight)+tyz.PX(n.paddingLeft)+tyz.PX(n.paddingRight)+tyz.PX(n.borderLeftWidth)+tyz.PX(n.borderRightWidth),o-h>0&&(s=tyz.PX(r[i].style.width),l=tyz.PX(r[i].style.height),h2vconvert.envs.isIE8&&(l=tyz.PX(h2v_ie.getOH(r[i]))),d=s-(o-h),d>0&&(c=l*d/s,tyz.setStyles(r[i],{width:d+"px",height:c+"px"}),e.style.marginRight=tyz.PX(n.marginRight)-(o-h)+"px")))}function o(e){var i,n=tyz.getByTag(t,e),a=0,r=0,o=0;for(a=0;a<n.length;a++)i=n[a].style,r=tyz.PX(i.width)+tyz.PX(i.paddingLeft)+tyz.PX(i.paddingRight)+tyz.PX(i.marginRight)+tyz.PX(i.marginLeft)+tyz.PX(i.borderLeftWidth)+tyz.PX(i.borderRightWidth),r-h>0&&(o=tyz.PX(i.width)-(r-h),o>0&&(n[a].style.width=o+"px"))}var s,l,d=[],h=tyz.PX(this.target[e].pagewidth);t.normalize(),l=document.createDocumentFragment(),l.appendChild(t),r(),o("PRE"),o("TABLE");for(var c,g,p,y,u,f,v=0,m=0,z=0;;){if(p=0,s=h+Math.ceil(m),c=n(t),null===c)break;g=Math.ceil(v+m+5),p-h>0&&(p=h),y=(0>=m?"0":"-"+Math.floor(m))+"px",u=tyz.newEle("DIV",{"class":"h2v_pinner"},{width:g+"px",right:y}),u.appendChild(this.extractRange(t,c.cnt)),f=this.envs.isIE8?h2v_ie.getOH(u):this.getDispS(u,["height"],!0,e,!0).height,d[d.length]=tyz.newEle("DIV",{"class":"h2v_page"},{width:p+"px",minHeight:i+"px",height:f}),d[d.length-1].appendChild(u),v=0,m=z,z=0}return y=(0>=m?0:"-"+Math.floor(m))+"px",g=Math.ceil(v+m+5),u=tyz.newEle("DIV",{"class":"h2v_pinner"},{width:g+"px",right:y}),u.appendChild(this.extractNodeContents(t)),f=this.envs.isIE8?h2v_ie.getOH(u):this.getDispS(u,["height"],!0,e,!0).height,d[d.length]=tyz.newEle("DIV",{"class":"h2v_page"},{width:s+"px",minHeight:i+"px",height:f}),d[d.length-1].appendChild(u),d;var _,S},addVTags:function(e){var t=e.cloneNode(!0);for(t.nodeValue=t.nodeValue.replace(this.orig_ex,function(e){return h2vconvert.repl_a[e]}),result=[],cname=[],place=[],plength=[];result=this.ptn.exec(t.nodeValue);)result[1]?cname[cname.length]="h2v_komoji":result[2]?cname[cname.length]="h2v_cho":result[3]?cname[cname.length]="h2v_kuto":result[4]?cname[cname.length]="h2v_sp":result[5]?cname[cname.length]="h2v_alpha":result[6]?cname[cname.length]="h2v_kakko_t_nr":result[7]?cname[cname.length]="h2v_kakko_b_nr":result[8]?cname[cname.length]="h2v_kakko_t":result[9]?cname[cname.length]="h2v_kakko_b":result[10]?cname[cname.length]="h2v_rotate":result[11]&&(cname[cname.length]="h2v_kuto_s"),plength[plength.length]=result[0].length,place[place.length]=this.ptn.lastIndex-result[0].length;var i,n,a,r,o,s=document.createDocumentFragment();for(s.appendChild(t),o=cname.length-1;o>=0;o--)i=t.splitText(place[o]+plength[o]),n=t.splitText(place[o]),a=tyz.newEle("SPAN",{"class":cname[o]}),r=document.createTextNode(n.nodeValue),a.appendChild(r),s.replaceChild(a,n);if(this.envs.isIE8){var l=tyz.newEle("DIV");l.appendChild(s.cloneNode(!0)),l.normalize(),s=document.createDocumentFragment(),s.appendChild(h2vconvert.extractNodeContents(l))}else s.normalize();for(;s.firstChild;)e.parentNode.insertBefore(s.firstChild,e);e.parentNode.removeChild(e)},resizeTimer:null,resizeFlag:!1,resizeW:0,doresize:function(){return h2vconvert.resizeFlag?!1:(h2vconvert.resizeFlag=!0,void(h2vconvert.resizeTimer=setInterval(function(){return h2vconvert.resizeW!=window.innerWidth?(h2vconvert.resizeW=window.innerWidth,!1):(clearInterval(h2vconvert.resizeTimer),h2vconvert.resizing(),setTimeout(function(){h2vconvert.resizeFlag=!1},1),void 0)},100)))},resizing:function(){var e,t,i,n,a=h2vconvert;for(i in a.target){if(e=tyz.getById(i),0==tyz.getByClass(e,"h2v").length)return!1;t=a.target[i],n=tyz.getById(i).offsetWidth-tyz.getPxStyle(e,"paddingLeft")-tyz.getPxStyle(e,"paddingRight")-tyz.getPxStyle(e,"borderLeftWidth")-tyz.getPxStyle(e,"borderRightWidth"),a.reConvert(t,n)&&!function(e,t,i){setTimeout(function(){try{h2vconvert.convert(e)}catch(n){h2vconvert.onErr(t,i)}},1)}(i,e,t)}},reConvert:function(e,t){return e.cols?e.fixedwidth&&Math.round(tyz.PX(e.fixedwidth))<=t?e.pagewidth==e.fixedwidth?!1:(e.pagewidth=e.fixedwidth,!0):Math.round(tyz.PX(e.pagewidth))==t?!1:(e.pagewidth=t+"px",!0):(e.pagewidth=e.fixedwidth&&Math.round(tyz.PX(e.fixedwidth))<=t?e.fixedwidth:t+"px",!0)},getNewProp:function(e,t,i,n,a){var r=h2vconvert.getDispS(e,["fontSize","width","height","marginTop","marginLeft","marginBottom","marginRight","paddingTop","paddingLeft","paddingBottom","paddingRight","borderTopStyle","borderRightStyle","borderBottomStyle","borderLeftStyle","borderLeftWidth","borderRightWidth","borderTopWidth","borderBottomWidth","textAlign","position","display"],a,n),o=tyz.PX(r.marginLeft)+tyz.PX(r.marginRight)+tyz.PX(r.paddingLeft)+tyz.PX(r.paddingRight)+tyz.PX(r.borderLeftWidth)+tyz.PX(r.borderRightWidth),s=tyz.PX(r.marginLeft)- -i/2-t/2+"px "+tyz.PX(r.marginTop)+"px "+tyz.PX(r.marginRight)+"px "+tyz.PX(r.marginBottom)+"px",l=tyz.PX(r.paddingLeft)+"px "+tyz.PX(r.paddingTop)+"px "+(tyz.PX(r.paddingRight)-t/2)+"px "+tyz.PX(r.paddingBottom)+"px",d={margin:s,padding:l,fontSize:tyz.PX(r.fontSize)+"px",lineHeight:tyz.PX(r.fontSize)- -t+"px",letterSpacing:"normal"},h=this.rotateBdr({Top:r.borderTopStyle,Right:r.borderRightStyle,Bottom:r.borderBottomStyle,Left:r.borderLeftStyle},e,n);for(var c in h)d[c]=h[c];return{s:d,xm:o,ds:r}},rotateBdr:function(e,t,i){function n(e){var t={Top:"Right",Right:"Bottom",Bottom:"Left",Left:"Top"};return t[e]}var a={};for(var r in e)if(e[r]&&"none"!=e[r]){a["border"+n(r)+"Style"]=e[r];var o=[];o.push("border"+r+"Width","border"+r+"Color");var s=this.getDispS(t,o,!1,i);a["border"+n(r)+"Width"]=s["border"+r+"Width"],a["border"+n(r)+"Color"]=s["border"+r+"Color"]}else a["border"+n(r)+"Style"]="none",a["border"+n(r)+"Width"]="0";return a},setLineMargin:function(e,t,i){var n=this.target[e];if(i&&(t+=(tyz.PX(i.marginTop)+tyz.PX(i.marginBottom)+tyz.PX(i.paddingTop)+tyz.PX(i.paddingBottom))/2),n.fsPX-t<0){var a=(t-n.fsPX)/2;n.mL-a<0&&(n.mL=a);var r=(t-n.fsPX)/2;n.mR-r<0&&(n.mR=r)}},addBar:function(e,t){var i="b"+e,n=tyz.getById(i)||tyz.newEle("DIV",{"class":"h2v_bar",id:i},{color:this.target[e].barForeColor,backgroundColor:this.target[e].barBackColor});n.innerHTML=t,tyz.getById(e).insertBefore(n,tyz.getById(e).firstChild)},addErrBar:function(e,t){var i="b"+e,n=tyz.getById(i)||tyz.newEle("DIV",{"class":"h2v_bar",id:i},{color:"#999",backgroundColor:"#eee"});n.innerHTML=t,tyz.getById(e).insertBefore(n,tyz.getById(e).firstChild)},showSplash:function(e){var t=tyz.getById(e),i=tyz.newEle("DIV",{"class":"h2v_splash",id:"sp"+e},{top:1*t.offsetTop+15+"px",left:t.offsetLeft+"px",width:t.offsetWidth-58+"px"});i.innerHTML="縦書きレイアウトに変換しています…",t.parentNode.appendChild(i),t.style.opacity="0.5",this.envs.isIE8&&(t.style.filter="alpha(opacity=50)")},hideSplash:function(e){var t=tyz.getById("sp"+e),i=tyz.getById(e).style;i.opacity=this.target[e].orgOpacity,this.envs.isIE8&&(i.filter=this.target[e].orgOpacity),t&&(t.style.opacity="0",setTimeout(function(){t.parentNode.removeChild(t)},500))},onErr:function(e,t){e.innerHTML="",e.parentNode.replaceChild(t.org.cloneNode(!0),e),this.addBar(t.id,'<a href="http://tategaki.info/h2v/" target="_blank">h2v.js Failed!</a>'),tyz.setStyles(tyz.getById(t.id),t.orgStyles)},isDispBlock:function(e,t){if(!this.isBlock(e)&&!this.isInline(e)&&"SPAN"!=e.nodeName)return!1;var i=h2vconvert.getDispS(e,["display"],!1,t).display;switch(i){case"block":return"b";case"inline-block":case"inline":return"i";default:return!1}},isBlock:function(e){switch(e.nodeName){case"DIV":case"P":case"BLOCKQUOTE":case"UL":case"OL":case"DL":case"H1":case"H2":case"H3":case"H4":case"H5":case"H6":case"ADDRESS":case"ARTICLE":case"ASIDE":case"FOOTER":case"HEADER":case"HGROUP":case"NAV":case"DETAILS":case"SECTION":case"SUMMARY":return!0;default:return!1}},isList:function(e){switch(e.nodeName){case"LI":case"DT":case"DD":return!0;default:return!1}},isInline:function(e){switch(e.nodeName){case"FONT":case"STRONG":case"BIG":case"SMALL":case"I":case"B":case"EM":case"SUB":case"SUP":case"A":case"MARK":case"TIME":case"METER":case"S":case"CITE":case"Q":case"DFN":case"ABBR":case"CODE":case"VAR":case"SAMP":case"KBD":return!0;default:return!1}},isThru:function(e){switch(e.nodeName){case"PRE":case"IFRAME":case"TABLE":case"TEXTAREA":case"FORM":case"AUDIO":case"CANVAS":case"EMBED":case"FIGURE":case"VIDEO":case"MENU":case"OBJECT":case"MAP":return!0;default:return!1}},span_match:function(e,t){return"SPAN"==e.nodeName&&tyz.getAttr(e,"class").match(t)?!0:!1},getLS:function(e,t){var i=this.getDispS(e,["letterSpacing"],!1,t),n=i.letterSpacing;switch(n){case"normal":case"initial":return 0;default:return tyz.PX(n)}},getDispS:function(e,t,i,n,a){for(var r,o,s,l,d,h=e.cloneNode(i),c=e.parentNode,g=0;c&&"#document-fragment"!=c.nodeName;)r=c.cloneNode(!1),r.appendChild(h),h=r,g++,c=c.parentNode;for(a?(o=h.cloneNode(i),this.tmpdiv.appendChild(o)):(s=tyz.newEle("DIV",{id:"h2v_tmp_sq"},{height:this.target[n].pageheight,width:this.target[n].pageheight}),o=h.cloneNode(!0),s.appendChild(o),this.tmpdiv.appendChild(s)),d=0;g>d;d++)o=o.lastChild;return l=tyz.getStyles(o,t),this.tmpdiv.removeChild(this.tmpdiv.lastChild),l},createTmpdiv:function(e){if(tyz.getById("h2v_tmp_div"))return tyz.getById("h2v_tmp_div");var t=this.target[e].orgHeight*tyz.getById(e).offsetWidth*tyz.PX(this.target[e].orgStyles.fontSize)/(this.target[e].chars*tyz.PX(this.target[e].fontsize)),i=Math.ceil(t*(1+2*this.target[e].lineInterval)),n=tyz.newEle("DIV",{id:"h2v_tmp_div","class":"h2v"},{width:i+"px",fontSize:this.target[e].fontsize,fontFamily:this.target[e].fontSet});return tyz.getById(e).appendChild(n),n},removeTmpdiv:function(e){tyz.getById("h2v_tmp_div")&&tyz.getById(e).removeChild(tyz.getById("h2v_tmp_div"))},rubyEnabled:!1,ruby_enabler:function(e){setTimeout(function(){h2vconvert.rubyEnabled=!0},1);var t,i,n,a,r,o=h2vconvert.envs,s=o.ua,l=tyz.getByTag(tyz.getById(e),"RUBY");if(/webkit/.test(s)||o.isIE){var d,h,c,g,p;for(t=l.length-1;t>=0;t--)if(l[t].normalize(),d=tyz.getByTag(l[t],"RBC"),h=tyz.getByTag(l[t],"RTC"),d.length==h.length){if(c=tyz.getByTag(l[t],"RB"),g=tyz.getByTag(l[t],"RT"),r=document.createDocumentFragment(),0!=c.length)for(i=0;i<c.length;i++)a=tyz.newEle("RUBY"),a.appendChild(document.createTextNode(c[i].innerHTML)),a.appendChild(g[i].cloneNode(!0)),r.appendChild(a.cloneNode(!0));else for(i=0;i<g.length;i++){for(a=tyz.newEle("RUBY"),p=g[i].previousSibling;"#text"!=p.nodeName;)try{p=p.previousSibling}catch(y){p=g[i].previousSibling;break}a.appendChild(p.cloneNode(!0)),a.appendChild(g[i].cloneNode(!0)),r.appendChild(a.cloneNode(!0))}l[t].parentNode.replaceChild(r,l[t])}}else{var u,f,v,m,g,c,h;for(t=l.length-1;t>=0;t--)if(l[t].innerHTML=l[t].innerHTML.replace(/[\n\r\t]/g,""),l[t].normalize(),u=document.defaultView.getComputedStyle(l[t],null),f=u.fontSize.replace("px",""),v=u.lineHeight.replace("px",""),m=(v-f)/2-2,m=0>=m?0:m,g=tyz.getByTag(l[t],"RT"),c=tyz.getByTag(l[t],"RB"),h=tyz.getByTag(l[t],"RTC"),0==h.length){var z,_,S,b;for(g.length<2?(z=document.createDocumentFragment(),_=document.createDocumentFragment()):(z=tyz.newEle("RBC"),_=tyz.newEle("RTC")),i=0;i<l[t].childNodes.length;i++)switch(S=l[t].childNodes[i],S.nodeName){case"#text":b=tyz.newEle("RB"),b.appendChild(S.cloneNode(!0)),z.appendChild(b);break;case"RB":z.appendChild(S.cloneNode(!0));break;case"RT":_.appendChild(S.cloneNode(!0)),m&&(_.lastChild.style.MozTransform="translate(0,"+m+"px)")}for(r=document.createDocumentFragment(),n=0;n<z.childNodes.length;n++)a=tyz.newEle("RUBY"),a.appendChild(z.childNodes[n].cloneNode(!0)),a.appendChild(_.childNodes[n].cloneNode(!0)),r.appendChild(a.cloneNode(!0));l[t].parentNode.replaceChild(r,l[t])}else{for(r=document.createDocumentFragment(),n=0;n<c.length;n++)a=tyz.newEle("RUBY"),a.appendChild(c[n].cloneNode(!0)),a.appendChild(g[n].cloneNode(!0)),r.appendChild(a.cloneNode(!0));l[t].parentNode.replaceChild(r,l[t]),m&&(h[0].style.MozTransform="translate(0,"+m+"px)")}if(!h2vconvert.rubyEnabled){var k=document.styleSheets[document.styleSheets.length-1];k.insertRule("ruby{display:inline-table;text-align:center !important ;text-indent:0 !important;margin:0;padding:0 !important;vertical-align:bottom}",k.cssRules.length),k.insertRule("ruby>rb,ruby>rbc{display:table-row-group;}",k.cssRules.length),k.insertRule("ruby>rt,ruby>rtc{display:table-header-group;font-size:8px;line-height:1em;letter-spacing:0 !important;font-weight:normal !important;font-style:normal !important;}",k.cssRules.length),k.insertRule("rbc>rb{display:table-cell;}",k.cssRules.length),k.insertRule("rtc>rt{display:table-cell;letter-spacing:0 !important;line-height:1em;}",k.cssRules.length),k.insertRule("rp{display:none !important;}",k.cssRules.length),h2vconvert.envs.isFF38&&(k.insertRule(".h2v_e ruby>.psdo_rb,#h2v_tmp_div ruby>.psdo_rb{display:table-cell !important;width:1em;max-width:1em;font-size:100%;word-wrap:break-word;word-break:break-all;vertical-align:middle;position:static;}",k.cssRules.length),k.insertRule(".h2v_e .psdo_rt,#h2v_tmp_div .psdo_rt{display:table-cell !important;font-size:70%;width:1em;max-width:1em;word-wrap:break-word;word-break:break-all;vertical-align:middle;position:static;}",k.cssRules.length)),/opera/gi.test(s)&&(k.insertRule("ruby,ruby>rb,ruby>rbc,ruby>rt,ruby>rtc,rbc>rb,rtc>rb{line-height:1em;}",k.cssRules.length),k.insertRule("ruby{vertical-align:0.95em;}",k.cssRules.length))
}}},ruby_to_html4_style:function(e){var t,i,n,a=tyz.newEle("RUBY");if(t=tyz.getByTag(e,"RT"),i=tyz.getByTag(e,"RBC"),n=tyz.getByTag(e,"RTC"),0==n.length){var r,o,s,l;t.length<2?(r=document.createDocumentFragment(),o=document.createDocumentFragment()):(r=tyz.newEle("RBC"),o=tyz.newEle("RTC"));for(var d=0;d<e.childNodes.length;d++)switch(s=e.childNodes[d],s.nodeName){case"#text":s.nodeValue=s.nodeValue.replace(/^\s+|\s+$/,""),l=tyz.newEle("RB"),l.appendChild(s.cloneNode(!0)),l.innerHTML='<span class="psdo_rb_inner">'+l.innerHTML+"</span>",r.appendChild(l);break;case"RB":l=s.cloneNode(!0),l.innerHTML='<span class="psdo_rb_inner">'+l.innerHTML+"</span>",r.appendChild(l);break;case"RT":l=s.cloneNode(!0),l.innerHTML='<span class="psdo_rt_inner">'+l.innerHTML+"</span>",o.appendChild(l)}return a.appendChild(r),a.appendChild(o),e.parentNode.replaceChild(a,e),a}if(0!=i.length)return e;throw new Error},ruby_to_html4_style_ff38:function(e){var t,i,n,a=tyz.newEle("RUBY");if(t=tyz.getByTag(e,"RT"),i=tyz.getByTag(e,"RBC"),n=tyz.getByTag(e,"RTC"),0==n.length){var r,o,s,l;t.length<2?(r=document.createDocumentFragment(),o=document.createDocumentFragment()):(r=tyz.newEle("RBC"),o=tyz.newEle("RTC"));for(var d=0;d<e.childNodes.length;d++)switch(s=e.childNodes[d],s.nodeName){case"#text":s.nodeValue=s.nodeValue.replace(/^\s+|\s+$/,""),l=tyz.newEle("SPAN"),l.setAttribute("class","psdo_rb"),l.appendChild(s.cloneNode(!0)),l.innerHTML='<span class="psdo_rb_inner">'+l.innerHTML+"</span>",r.appendChild(l);break;case"RB":l=tyz.newEle("SPAN"),l.setAttribute("class","psdo_rb"),l.innerHTML='<span class="psdo_rb_inner">'+s.innerHTML+"</span>",r.appendChild(l);break;case"RT":l=tyz.newEle("SPAN"),l.setAttribute("class","psdo_rt"),l.innerHTML='<span class="psdo_rt_inner">'+s.innerHTML+"</span>",o.appendChild(l)}return a.appendChild(r),a.appendChild(o),e.parentNode.replaceChild(a,e),a}if(0!=i.length)return e;throw new Error},h2v:function(e,t){this.id=t;var i,n,a,r=e[t],o=h2vconvert;for(i in o.defaultval)this[i]=o.defaultval[i];for(i in r)this[i]=r[i];n=tyz.getById(t),a=n.offsetWidth-tyz.getPxStyle(n,"paddingLeft")-tyz.getPxStyle(n,"paddingRight")-tyz.getPxStyle(n,"borderLeftWidth")-tyz.getPxStyle(n,"borderRightWidth"),this.pagewidth=void 0!==r.pagewidth?r.pagewidth:a+"px",this.fixedwidth=void 0!==r.pagewidth?r.pagewidth:!1,tyz.PX(this.pagewidth)>a&&(this.pagewidth=a+"px"),this.fsPX=tyz.PX(this.fontsize),this.pageheight=this.chars*this.fsPX+"px",this.mR=0,this.mL=0,this.lineSpace=Math.round(this.fsPX*this.lineInterval/2),this.cH=0,this.tAlign=0,this.org=document.createDocumentFragment(),this.org.appendChild(n.cloneNode(!0)),this.orgStyles=tyz.getStyles(n,["fontSize","fontFamily"]),this.orgStyles.visibility="visible",this.orgHeight=n.offsetHeight,this.orgOpacity=o.envs.isIE8?tyz.getStyle(n,"msFilter"):tyz.getStyle(n,"opacity"),this.okuri=null,this.html="",this.converted="",this.fontSet="mincho"==this.fontSet.toLowerCase()?o.fontSet.mincho:o.fontSet.gothic,this.flt=!1,this.floatCount=0,this.justify=!1},extractRange:function(e,t){var i=document.createRange();return i.setStartBefore(e.firstChild),i.setEndAfter(t),i.extractContents()},extractNodeContents:function(e){var t=document.createRange();return t.selectNodeContents(e),t.extractContents()},switcher:function(e){var t=this.target[e],i=tyz.getById(e);if(tyz.getByClass(i,"h2v").length)i.innerHTML="",i.parentNode.replaceChild(t.org.cloneNode(!0),i),i=tyz.getById(e),t.bar&&this.addBar(t.id,"<span onclick=\"h2vconvert.switcher( '"+e+"');\">横→縦切替</span>"),tyz.setStyles(i,t.orgStyles);else{var n=i.offsetWidth-tyz.getPxStyle(i,"paddingLeft")-tyz.getPxStyle(i,"paddingRight")-tyz.getPxStyle(i,"borderLeftWidth")-tyz.getPxStyle(i,"borderRightWidth");if(this.reConvert(t,n))t.splash&&this.showSplash(e),function(e,t,i){setTimeout(function(){try{h2vconvert.convert(e)}catch(n){h2vconvert.onErr(t,i)}i.splash&&h2vconvert.hideSplash(e)},1)}(e,i,t);else try{i.innerHTML="",t.bar&&this.addBar(t.id,"<span onclick=\"h2vconvert.switcher( '"+e+"');\">縦→横切替</span>"),i.style.fontFamily=t.fontSet,i.appendChild(t.cols.cloneNode(!0)),i.appendChild(tyz.newEle("DIV",{"class":"h2v_clearfix"}))}catch(a){this.onErr(i,t)}}},komojis:["ぁ","ぃ","ぅ","ぇ","ぉ","っ","ゃ","ゅ","ょ","ゎ","ァ","ィ","ゥ","ェ","ォ","ッ","ャ","ュ","ョ","ヮ"].join(""),kakko_t_kagi_a:["「","『"],kakko_t_kagi_r_a:["﹁","﹃"],kakko_t_a:["（","｛","〈","《","〔","【"],kakko_t_r_a:["︵","︷","︿","︽","︹","︻"],kakko_b_kagi_a:["」","』"],kakko_b_kagi_r_a:["﹂","﹄"],kakko_b_a:["）","｝","〉","》","〕","】"],kakko_b_r_a:["︶","︸","﹀","︾","︺","︼"],dash_a:["―","—","‥","ー"],dash_r_a:["︱","︱","︰","丨"],kakkos_tr:["［","〘"].join(""),kakkos_br:["］","〙"].join(""),rotates:["↑","↓","→","←","…","＝","−","：","；","＜","＞"].join(""),rotate_mirrors:["〜","～"].join(""),kutos:["。","、","，"].join(""),orig_ex:null,repl_a:[],ptn:null},tyz={getByClass:function(e,t){if(e.getElementsByClassName)return e.getElementsByClassName(t);for(var i=tyz.getByTag(e,"*"),n=[],a=0;a<i.length;a++)tyz.getAttr(i[a],"class")==t&&(n[n.length]=i[a]);return n},getById:function(e){return document.getElementById(e)},getByTag:function(e,t){return e.getElementsByTagName(t)},getStyle:function(e,t){return document.defaultView.getComputedStyle(e,null)[t]},getStyles:function(e,t){for(var i=document.defaultView.getComputedStyle(e,null),n={},a=0;a<t.length;a++)n[t[a]]=i[t[a]];return n},getAttr:function(e,t){return e.getAttribute(t)||""},PX:function(e){return e+="",""==e?0:e.match("px")?tyz.round(1*e.replace("px",""),2):e.match("pt")?tyz.round(4*e.replace("pt","")/3,2):e.match("em")?tyz.round(e.replace("em","")*h2vconvert.defaultFS*1,2):e.match(/[^0-9\.]/g)?0:tyz.round(1*e,2)},getPxStyle:function(e,t){var i=document.defaultView.getComputedStyle(e,null);return this.PX(i[t])},setStyles:function(e,t){for(var i in t)e.style[i]=t[i];return e},newEle:function(e,t,i){var n,a,r=document.createElement(e);for(n in t)r.setAttribute(n,t[n]);for(a in i)r.style[a]=i[a];return r},round:function(e,t){var i=Math.pow(10,t);return Math.round(e*i)/i},ceil:function(e,t){var i=Math.pow(10,t);return Math.ceil(e*i)/i},floor:function(e,t){var i=Math.pow(10,t);return Math.floor(e*i)/i}},h2v_ie={getStyle:function(e,t){return h2v_ie.checkVal_w(t)||h2v_ie.checkVal_h(t)?h2v_ie.getSize(e,t)+"px":"fontSize"==t?h2v_ie.getFontSize(e)+"px":"cssFloat"==t?e.currentStyle.styleFloat:"letterSpacing"==t?h2v_ie.getSize(e,t)+"px":e.currentStyle[t]},getStyles:function(e,t){var i,n={};for(i=0;i<t.length;i++)n[t[i]]=h2v_ie.getStyle(e,t[i]);return n},getPxStyle:function(e,t){var i=h2v_ie.getStyle(e,t);return tyz.PX(i)},getAttr:function(e,t){return"class"==t?e.className||"":e.getAttribute(t)||""},setStyles:function(e,t){for(var i in t)"cssFloat"!=i?e.style[i]=t[i]:e.style.styleFloat=t[i];return e},checkVal_w:function(e){switch(e){case"width":case"marginLeft":case"marginRight":case"paddingLeft":case"paddingRight":case"borderLeftWidth":case"borderRightWidth":return!0;default:return!1}},checkVal_h:function(e){switch(e){case"height":case"marginTop":case"marginBottom":case"paddingTop":case"paddingBottom":case"borderTopWidth":case"borderBottomWidth":return!0;default:return!1}},getFontSize:function(e){var t,i=tyz.newEle("DIV",{},{width:"10em",letterSpacing:"normal"});try{e.appendChild(i),t=Math.ceil(i.offsetWidth/10),e.removeChild(i)}catch(n){t=e.parentNode&&"HTML"!=e.parentNode.nodeName?h2v_ie.getFontSize(e.parentNode):14}return t},getSize:function(e,t,i){var n=e.currentStyle[t];if(n.match("px"))return 1*n.replace("px","");if(n.match("%")){var a=n.replace("%","")/100,r=h2v_ie.checkVal_w(t)?"width":"height",o=h2v_ie.getSize(e.parentNode,r,!0);return a*o}if(n.match("pt"))return tyz.round(3*n.replace("pt","")/4+.01,0);if(n.match("em"))return tyz.round(n.replace("em","")*tyz.PX(h2v_ie.getFontSize(e))+.01,0);if(n.match("auto"))return"width"==t?e.offsetWidth-h2v_ie.getPxStyle(e,"paddingLeft")-h2v_ie.getPxStyle(e,"paddingRight")-h2v_ie.getPxStyle(e,"borderLeftWidth")-h2v_ie.getPxStyle(e,"borderRightWidth"):"height"==t&&i?e.offsetHeight-h2v_ie.getPxStyle(e,"paddingTop")-h2v_ie.getPxStyle(e,"paddingBottom")-h2v_ie.getPxStyle(e,"borderTopWidth")-h2v_ie.getPxStyle(e,"borderBottomWidth"):0;if(t.match(/border/)){var s=h2v_ie.getStyle(e,t.replace("Width","Style"));if("none"!=s&&"hidden"!=s){if("thin"==n)return 2;if("medium"==n)return 4;if("thick"==n)return 6}return 0}return 0},extractRange:function(e,t){var i=document.createDocumentFragment();for(e.childNodes.length;;){var n=e.firstChild;if(!n)break;if(n===t){i.appendChild(e.removeChild(n));break}var a=!1;if("#text"!=n.nodeName){var r=t;"#text"==r.nodeName?(r=r.parentNode,a="#document-fragment"==r.nodeName?!1:n.contains(r)):a=n.contains(r)}if(a){i.appendChild(n.cloneNode(!1));var o=h2vconvert.extractRange(n,t);i.lastChild.appendChild(o),n.hasChildNodes()||e.removeChild(n);break}i.appendChild(e.removeChild(n))}return i},extractNodeContents:function(e){for(var t=document.createDocumentFragment(),i=e.firstChild;i;)t.appendChild(e.removeChild(i)),i=e.firstChild;return t},getOH:function(e){var t=h2vconvert,i=e.cloneNode(!0);t.tmpdiv.appendChild(i);var n=i.offsetHeight+1+"px";return t.tmpdiv.removeChild(i),n},setStyleSheet:function(){var e=document.styleSheets[document.styleSheets.length-1];if(e.addRule(".h2v_e span.h2v_sp","height:1em;"),h2vconvert.envs.isIE8){var e=document.styleSheets[document.styleSheets.length-1];e.addRule(".h2v_e span.h2v_cho","filter:progid:DXImageTransform.Microsoft.BasicImage(rotation=1, mirror=1);"),e.addRule(".h2v_e span.h2v_alpha,.h2v_e span.h2v_sp,.h2v_e span.h2v_rotate","filter:progid:DXImageTransform.Microsoft.BasicImage(rotation=1);"),e.addRule(".h2v_e .h2v_kakko_t,.h2v_e .h2v_kakko_b","filter:progid:DXImageTransform.Microsoft.BasicImage(rotation=1);font-family:'ＭＳ ゴシック','MS Gochic' !important;")}}};!function(){var e=h2vconvert,t=e.envs;t.ua=navigator.userAgent.toLowerCase();var i=t.ua,n=window.opera?opera.version().replace(/\d$/,"")-0:parseFloat((/(?:ie |fox\/|ome\/|ion\/|rv:)(\d+\.\d)/.exec(i)||[,0])[1]);/msie/.test(i)&&void 0!==document.documentMode&&(n=document.documentMode),(/opera/.test(i)&&10.5>n||/firefox/.test(i)&&3.5>n||!/chrome/.test(i)&&!/opera/.test(i)&&/safari/.test(i)&&!/mobile/.test(i)&&3>n||/msie/.test(i)&&8>n)&&(t.isOld=!0),/trident/.test(i)&&(t.isIE=!0),/msie/.test(i)&&9>n&&(t.isIE8=!0),t.isIE8&&(tyz.getStyle=h2v_ie.getStyle,tyz.getStyles=h2v_ie.getStyles,tyz.getPxStyle=h2v_ie.getPxStyle,tyz.setStyles=h2v_ie.setStyles,e.extractRange=h2v_ie.extractRange,e.extractNodeContents=h2v_ie.extractNodeContents,tyz.newEle("RB")),/webkit|opera/.test(i)&&(e.getExtraHeight=e.getExtraHeight_webkit),/firefox/.test(i)&&n>=38&&(t.isFF38=!0,e.ruby_to_html4_style=e.ruby_to_html4_style_ff38),document.addEventListener?window.addEventListener("resize",h2vconvert.doresize,!1):window.attachEvent("onresize",h2vconvert.doresize);var a,r,o,s,l;if(/windows nt 5/.test(i)){for(a=e.kakko_t_a.concat(e.kakko_b_a,e.dash_a),r=e.kakko_t_r_a.concat(e.kakko_b_r_a,e.dash_r_a),e.orig_ex=RegExp("("+a.join("|")+")","g"),o=0;o<a.length;o++)e.repl_a[a[o]]=r[o];e.kakkos_tr+=e.kakko_t_kagi_a.join(""),e.kakkos_br+=e.kakko_b_kagi_a.join(""),s=e.kakko_t_r_a.join(""),l=e.kakko_b_r_a.join("")}else{for(a=e.kakko_t_a.concat(e.kakko_b_a,e.kakko_t_kagi_a,e.kakko_b_kagi_a,e.dash_a),r=e.kakko_t_r_a.concat(e.kakko_b_r_a,e.kakko_t_kagi_r_a,e.kakko_b_kagi_r_a,e.dash_r_a),e.orig_ex=RegExp("("+a.join("|")+")","g"),o=0;o<a.length;o++)e.repl_a[a[o]]=r[o];s=e.kakko_t_r_a.join("")+e.kakko_t_kagi_r_a.join(""),l=e.kakko_b_r_a.join("")+e.kakko_b_kagi_r_a.join("")}h2vconvert.ptn=RegExp("(["+e.komojis+"])|(["+e.rotate_mirrors+"])|(["+e.kutos+"])|( |\\u00A0)|([!-~‘”“’]+\\s?)|(["+s+"])|(["+l+"])|(["+e.kakkos_tr+"])|(["+e.kakkos_br+"])|(["+e.rotates+"])|([！？])","g")}();